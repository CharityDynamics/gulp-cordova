# Android

## Usage

The most simple way of using this plugin is by providing a cordova project directory as input.

```JavaScript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-build-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android());
});
```

This will build the project for the android platform.

The plugin returns the apk generated by running the command. This apk can then be stored in destination folder.

```JavaScript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android())
        .pipe(gulp.dest('builds'));
});
```

This will store the `apk` in the `build` directory.

### Signing

If you want to let the plugin sign the `apk` for release, you can provide extra options.

```JavaScript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android({storeFile: '/Path/to/key.keystore', keyAlias: 'my_alias'}))
        .pipe(gulp.dest('builds'));
});
```

When this command is ran, it will ask for the keystore password and for the alias password. If you provide it, it will store
the signed apk in the `builds` directory.

If you don't want to provide the passwords over and over again, it is possible to provide the passwords via the options object.

```JavaScript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android({
            storeFile: '/Path/to/key.keystore',
            storePassword: 'mypass',
            keyAlias: 'my_alias',
            keyPassword: 'keypass'
        }))
        .pipe(gulp.dest('builds'));
});
```

## Plugin I/O

The plugin expects a cordova project folder as input file and returns the `.apk` as output file. This makes it possible
to define the following tasks.

```JavaScript
var gulp = require('gulp'),
    create = require('gulp-create'),
    plugin = require('gulp-cordova-plugin'),
    icon = require('gulp-cordova-icon'),
    android = require('gulp-cordova-build-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create());
});

gulp.task('plugin', ['create'], function() {
    return gulp.src('.cordova')
        .pipe(plugin('org.apache.cordova.file'))
        .pipe(plugin('org.apache.cordova.inappbrowser'));
});

gulp.task('icon', ['plugin'], function() {
    return gulp.src('.cordova')
        .pipe(icon('res/icon.png'));
});

gulp.task('android', ['icon'], function() {
    return gulp.src('.cordova')
        .pipe(android())
        .pipe(gulp.dest('builds'));
});

gulp.task('build', ['android']);
```

If you run the `android` task, it will first run the `icon` task, which will run the `plugin` task which on his turn will first run the
`create` task. If the project is created, it will add the plugins, generates the icons, builds the project and stores the apk file
in the `builds` directory.