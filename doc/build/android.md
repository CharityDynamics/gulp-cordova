# Android

## Usage

The most simple way of using this plugin is by providing a cordova project directory as input.

```javascript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-build-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android());
});
```

This will build the project for the android platform.

The plugin returns all the apk files generated by running the command. These apks can then be stored in a destination folder.

```javascript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android())
        .pipe(gulp.dest('builds'));
});
```

This will store all the `apk` files in the `build` directory.

### Release build

If you want to create an unsigned release build, you can by setting the `release` flag to true.

```javascript
gulp.task('build', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android({release: true}))
        .pipe(gulp.dest('builds'));
});
```

### Signing

If you want to create a signed `apk` for release, you can provide extra options. Note that you don't have to set `release` explicitly to `true`.

```javascript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android({storeFile: '/Path/to/key.keystore', keyAlias: 'my_alias'}))
        .pipe(gulp.dest('builds'));
});
```

When this command is ran, it will ask for the keystore password and for the alias password. If you provide it, it will sign the apk for you.

If you don't want to provide the passwords over and over again, it is possible to provide the passwords via the options object.

```javascript
var gulp = require('gulp'),
    create = require('gulp-create'),
    android = require('gulp-cordova-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create())
        .pipe(android({
            storeFile: '/Path/to/key.keystore',
            storePassword: 'mypass',
            keyAlias: 'my_alias',
            keyPassword: 'keypass',
            storeType: 'pkcs12'
        }))
        .pipe(gulp.dest('builds'));
});
```

## Plugin I/O

The plugin expects a cordova project folder as input file and returns all the `.apk` files as output files. This makes it possible to define the following tasks.

```javascript
var gulp = require('gulp'),
    create = require('gulp-create'),
    plugin = require('gulp-cordova-plugin'),
    icon = require('gulp-cordova-icon'),
    android = require('gulp-cordova-build-android');

gulp.task('create', function() {
    return gulp.src('dist')
        .pipe(create());
});

gulp.task('plugin', ['create'], function() {
    return gulp.src('.cordova')
        .pipe(plugin('org.apache.cordova.file'))
        .pipe(plugin('org.apache.cordova.inappbrowser'));
});

gulp.task('icon', ['plugin'], function() {
    return gulp.src('.cordova')
        .pipe(icon('res/icon.png'));
});

gulp.task('android', ['icon'], function() {
    return gulp.src('.cordova')
        .pipe(android())
        .pipe(gulp.dest('builds'));
});

gulp.task('build', ['android']);
```

If you run the `android` task, it will first run the `icon` task, which will run the `plugin` task which on his turn will first run the
`create` task. If the project is created, it will add the plugins, generates the icons, builds the project and stores the apk file
in the `builds` directory.
